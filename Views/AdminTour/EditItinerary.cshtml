@model TourDuLich.Models.Tour
@{
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
    ViewData["Title"] = "C·∫≠p Nh·∫≠t H√†nh Tr√¨nh - " + Model.TourName;
}

<div class="container mt-4">
    <!-- Tieu de trang -->
    <div class="page-title">
        <h2><i class="bi bi-pencil-square"></i> C·∫≠p Nh·∫≠t H√†nh Tr√¨nh</h2>
    </div>

    <!-- Thong bao -->
    @if (TempData["SuccessMessage"] != null)
    {
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            <i class="bi bi-check-circle me-2"></i>
            @TempData["SuccessMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    }

    @if (TempData["ErrorMessage"] != null)
    {
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
            <i class="bi bi-exclamation-triangle me-2"></i>
            @TempData["ErrorMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    }

    <!-- Thong tin tour -->
    <div class="admin-box mb-4">
        <h3 class="text-primary mb-3">@Model.TourName</h3>
        <div class="row">
            <div class="col-md-4">
                <p><strong>Danh m·ª•c:</strong> <span class="badge bg-primary">@Model.GetCategoryDisplayName()</span></p>
                <p><strong>Gi√°:</strong> <span class="text-success fw-bold">@Model.Price.ToString("N0") ƒë</span></p>
            </div>
            <div class="col-md-4">
                <p><strong>ƒê·ªãa ƒëi·ªÉm:</strong> @Model.Location</p>
                <p><strong>Th·ªùi gian:</strong> @Model.Duration</p>
            </div>
            <div class="col-md-4">
                <p><strong>Ph∆∞∆°ng ti·ªán:</strong> @Model.Transportation</p>
                <p><strong>Kh·ªüi h√†nh t·ª´:</strong> @Model.DepartureFrom</p>
            </div>
        </div>
    </div>

    <!-- Form cap nhat hanh trinh -->
    <div class="form-container-modern">
        <form asp-action="EditItinerary" method="post">
            <input type="hidden" asp-for="TourId" />
            
            <div class="mb-4">
                <label class="form-label fw-bold">
                    <i class="bi bi-map me-2"></i> H√†nh Tr√¨nh Chi Ti·∫øt
                </label>
                <div class="alert alert-info">
                    <strong>H∆∞·ªõng d·∫´n:</strong> Nh·∫≠p h√†nh tr√¨nh t·ª´ng ng√†y, m·ªói ng√†y c√°ch nhau b·∫±ng d·∫•u "||" (hai d·∫•u g·∫°ch d·ªçc).
                    <br>
                    <strong>V√≠ d·ª•:</strong> Ng√†y 1: Kh·ªüi h√†nh t·ª´ TP.HCM...||Ng√†y 2: Tham quan ƒë·ªãa ƒëi·ªÉm A...||Ng√†y 3: V·ªÅ TP.HCM
                </div>
                <textarea name="itinerary" class="form-control form-control-modern" rows="15" 
                          placeholder="Nh·∫≠p h√†nh tr√¨nh chi ti·∫øt t·ª´ng ng√†y...">@Model.Itinerary</textarea>
            </div>

            <div class="text-center">
                <button type="submit" class="btn btn-success btn-lg px-5 me-3">
                    <i class="bi bi-check-circle me-2"></i> L∆∞u H√†nh Tr√¨nh
                </button>
                <a asp-action="ViewItinerary" asp-route-id="@Model.TourId" class="btn btn-secondary btn-lg px-5 me-3">
                    <i class="bi bi-eye me-2"></i> Xem H√†nh Tr√¨nh
                </a>
                <a asp-action="Index" class="btn btn-outline-secondary btn-lg px-5">
                    <i class="bi bi-arrow-left me-2"></i> Quay L·∫°i
                </a>
            </div>
        </form>
    </div>

    <!-- Huong dan chi tiet -->
    <div class="admin-box mt-4">
        <h5 class="text-primary mb-3">
            <i class="bi bi-info-circle me-2"></i> H∆∞·ªõng D·∫´n Chi Ti·∫øt
        </h5>
        
        <div class="row">
            <div class="col-md-6">
                <h6 class="text-success">‚úÖ C√°ch vi·∫øt h√†nh tr√¨nh:</h6>
                <ul class="list-unstyled">
                    <li class="mb-2">‚Ä¢ M·ªói ng√†y l√† m·ªôt ƒëo·∫°n vƒÉn ri√™ng bi·ªát</li>
                    <li class="mb-2">‚Ä¢ S·ª≠ d·ª•ng "||" ƒë·ªÉ ph√¢n t√°ch c√°c ng√†y</li>
                    <li class="mb-2">‚Ä¢ C√≥ th·ªÉ s·ª≠ d·ª•ng HTML ƒë∆°n gi·∫£n (br, strong, em)</li>
                    <li class="mb-2">‚Ä¢ N√™n b·∫Øt ƒë·∫ßu m·ªói ng√†y b·∫±ng "Ng√†y X:"</li>
                </ul>
            </div>
            <div class="col-md-6">
                <h6 class="text-warning">‚ö†Ô∏è L∆∞u √Ω:</h6>
                <ul class="list-unstyled">
                    <li class="mb-2">‚Ä¢ Kh√¥ng s·ª≠ d·ª•ng k√Ω t·ª± ƒë·∫∑c bi·ªát kh√°c</li>
                    <li class="mb-2">‚Ä¢ Ki·ªÉm tra k·ªπ tr∆∞·ªõc khi l∆∞u</li>
                    <li class="mb-2">‚Ä¢ H√†nh tr√¨nh s·∫Ω hi·ªÉn th·ªã tr√™n trang chi ti·∫øt tour</li>
                    <li class="mb-2">‚Ä¢ C√≥ th·ªÉ c·∫≠p nh·∫≠t b·∫•t c·ª© l√∫c n√†o</li>
                </ul>
            </div>
        </div>

        <div class="mt-4 p-3 bg-light rounded">
            <h6 class="text-primary">üìù V√≠ d·ª• m·∫´u:</h6>
            <code class="d-block mt-2" style="white-space: pre-line; font-size: 0.9rem;">
Ng√†y 1: Kh·ªüi h√†nh t·ª´ TP. H·ªì Ch√≠ Minh
- 06:00: T·∫≠p trung t·∫°i s√¢n bay T√¢n S∆°n Nh·∫•t
- 08:00: Bay ƒë·∫øn H√† N·ªôi
- 12:00: D√πng c∆°m tr∆∞a, nh·∫≠n ph√≤ng kh√°ch s·∫°n
- 14:00: Tham quan H·ªì Ho√†n Ki·∫øm, ƒê·ªÅn Ng·ªçc S∆°n
- 18:00: D√πng c∆°m t·ªëi, ngh·ªâ ng∆°i||Ng√†y 2: Tham quan H·∫° Long
- 07:00: D√πng s√°ng t·∫°i kh√°ch s·∫°n
- 08:00: Kh·ªüi h√†nh ƒëi H·∫° Long (3.5 gi·ªù)
- 12:00: L√™n du thuy·ªÅn, d√πng c∆°m tr∆∞a
- 14:00: Tham quan ƒê·ªông Thi√™n Cung
- 16:00: T·∫Øm bi·ªÉn t·∫°i b√£i Titop
- 19:00: D√πng c∆°m t·ªëi tr√™n thuy·ªÅn, ngh·ªâ ƒë√™m tr√™n v·ªãnh
            </code>
        </div>
    </div>
</div>

<script>
// Auto-resize textarea
document.addEventListener('DOMContentLoaded', function() {
    const textarea = document.querySelector('textarea[name="itinerary"]');
    if (textarea) {
        textarea.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = (this.scrollHeight) + 'px';
        });
        
        // Initial resize
        textarea.style.height = (textarea.scrollHeight) + 'px';
    }
});
</script>
